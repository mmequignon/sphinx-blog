

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Proper way to deal with python packages &mdash; Fwzte Personnal notes and thoughts about computer science. documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Fwzte Personnal notes and thoughts about computer science. documentation" href="../index.html"/>
        <link rel="up" title="Tutos" href="index.html"/>
        <link rel="next" title="Tips â€˜n Tricks" href="../tipsntricks/index.html"/>
        <link rel="prev" title="Reverse proxy with Apache (and HTTPS !)" href="apache.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Fwzte
          

          
            
            <img src="../_static/logo.png" class="logo" />
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="prepadedie.html">My dedicated server installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="prepadedie.html#host-configuration">Host configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="prepadedie.html#lvm">LVM</a></li>
<li class="toctree-l3"><a class="reference internal" href="prepadedie.html#lxc">LXC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="prepadedie.html#lxc-create">lxc-create</a></li>
<li class="toctree-l4"><a class="reference internal" href="prepadedie.html#containers-configuration">Containers configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="prepadedie.html#managing-container-resources">Managing container resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="prepadedie.html#rudiments">Rudiments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="prepadedie.html#iptables">Iptables</a></li>
<li class="toctree-l3"><a class="reference internal" href="prepadedie.html#ssmtp">Ssmtp</a></li>
<li class="toctree-l3"><a class="reference internal" href="prepadedie.html#smartmontools">Smartmontools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="prepadedie.html#daemon-configuration">Daemon configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="prepadedie.html#rsyslog">Rsyslog</a><ul>
<li class="toctree-l4"><a class="reference internal" href="prepadedie.html#server-configuration">Server configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="prepadedie.html#client-configuration">Client configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="prepadedie.html#ansible">Ansible</a><ul>
<li class="toctree-l4"><a class="reference internal" href="prepadedie.html#initial-configuration">Initial configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="prepadedie.html#notes">Notes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="prepadedie.html#mount-inside-a-container">Mount inside a container</a></li>
<li class="toctree-l4"><a class="reference internal" href="prepadedie.html#ip-failover">IP failover</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dnsmasq.html">LXC and Dnsmasq</a></li>
<li class="toctree-l2"><a class="reference internal" href="acpi-systemd.html">ACPI events management with systemd</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration-mails.html">Mails migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="apache.html">Reverse proxy with Apache (and HTTPS !)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Proper way to deal with python packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-we-want">What we want</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-we-need">What we need</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-to-work">Time to work</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tipsntricks/index.html">Tips &#8216;n Tricks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tipsntricks/x2x.html">How to drive a remote computer with X2GO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tipsntricks/vim.html">Just a vim reminder</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tipsntricks/vim.html#basics">Basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tipsntricks/vim.html#use-the-force-use-hjkl">Use the force, use hjkl !</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tipsntricks/vim.html#modes">Modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tipsntricks/vim.html#commands">Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tipsntricks/vim.html#cut-copy-paste">Cut / Copy / Paste</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tipsntricks/vim.html#advanced">Advanced</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tipsntricks/vim.html#cut-copy-again">Cut / Copy (again)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tipsntricks/vim.html#cursor-manipulation">Cursor manipulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tipsntricks/vim.html#manipulation">Manipulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tipsntricks/vim.html#windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tipsntricks/vim.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tipsntricks/deb_packages.html">.deb packages modification</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../scripts/ccppp.html">CCPPP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/lxc-up_down.html">lxc-up / down</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../scripts/lxc-up_down.html#lxc-up">lxc up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scripts/lxc-up_down.html#lxc-down">lxc-down</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/pg-cli.html">pg-cli</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../thoughts/index.html">Personal Thoughts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../thoughts/how-to-eat-better.html">How to eat better ?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../thoughts/how-to-eat-better.html#what-about-massive-meat-production-factories">What about massive meat production factories ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thoughts/how-to-eat-better.html#so-do-we-have-alternatives">So, do we have alternatives ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thoughts/how-to-eat-better.html#what-could-i-do-to-make-things-better">What could I do to make things better ?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../thoughts/how-to-eat-better.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Fwzte</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tutos</a> &raquo;</li>
        
      <li>Proper way to deal with python packages</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="proper-way-to-deal-with-python-packages">
<h1>Proper way to deal with python packages<a class="headerlink" href="#proper-way-to-deal-with-python-packages" title="Permalink to this headline">Â¶</a></h1>
<p>Today, in order to see what python packages I&#8217;ve installed with pip, I tried this to list them, and then :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ pip list
ansible (2.2.1.0)
apsw (3.13.0.post1)
arandr (0.1.9)
astroid (1.4.8)
backports.functools-lru-cache (1.2.1)
BeautifulSoup (3.2.1)
beautifulsoup4 (4.5.3)
blinker (1.4)
chardet (2.3.0)
CherryPy (3.5.0)
configparser (3.5.0)
cryptography (1.7.1)
cssselect (1.0.1)
cssutils (1.0)
dnspython (1.15.0)
docutils (0.12)
enum34 (1.1.6)
feedgenerator (1.9)
feedparser (5.1.3)
flake8 (3.2.1)
[â€¦]
futures (3.0.5)
pygobject (3.22.0)
pygtkspellcheck (4.0.5)
python-apt (1.4.0b3)
python-dateutil (2.5.3)
python-debian (0.1.30)
python-debianbts (2.6.1)
pytz (2016.7)
pyxdg (0.25)
PyYAML (3.12)
reportbug (6.6.6)
repoze.lru (0.6)
restructuredtext-lint (0.12.2)
Routes (2.3.1)
SecretStorage (2.3.1)
setuptools (26.1.1)
simplejson (3.10.0)
six (1.10.0)
trollius (2.1)
Unidecode (0.4.19)
uTidylib (0.3)
virtualenv (15.1.0)
webencodings (0.5)
WebOb (1.6.2)
wheel (0.29.0)
wrapt (1.10.8)
wxPython (3.0.2.0)
wxPython-common (3.0.2.0)
xmltodict (0.10.2)
zim (0.65)
</pre></div>
</div>
<p>I must admin that I am just unable to say why I have all of these packages installed, nor to say what programs depends on them.
So I&#8217;ve decided to manage them in an other way.</p>
<div class="section" id="what-we-want">
<h2>What we want<a class="headerlink" href="#what-we-want" title="Permalink to this headline">Â¶</a></h2>
<p>We want to deal our packages in a simple way.
An ideal way would be that when we do not need a programm anymore, I remove it, and it&#8217;s depends too.
It&#8217;s actually possible.</p>
</div>
<div class="section" id="what-we-need">
<h2>What we need<a class="headerlink" href="#what-we-need" title="Permalink to this headline">Â¶</a></h2>
<p>We will need a few packages <code class="docutils literal"><span class="pre">virtualenv</span></code>, <code class="docutils literal"><span class="pre">python-pip</span></code> and <code class="docutils literal"><span class="pre">python3-pip</span></code>.
To explain a little how it will work :</p>
<blockquote>
<div><ul class="simple">
<li>We will create a folder /opt/envs in which we will create a virtualenv for each programm</li>
<li>In those virtualenvs, we will install each dependancies the programm will need</li>
</ul>
</div></blockquote>
<p>You will ask here, &#8220;Hey but, what if two or more programs needs the same python package ?&#8221;
Well, that&#8217;s true, we will install it each time a program will depend on it.</p>
</div>
<div class="section" id="time-to-work">
<h2>Time to work<a class="headerlink" href="#time-to-work" title="Permalink to this headline">Â¶</a></h2>
<p>pip installation</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">python3</span><span class="o">-</span><span class="n">pip</span>
</pre></div>
</div>
<p>virtualenv installation</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">install</span> <span class="n">virtualenv</span>
</pre></div>
</div>
<p>we will virtualenv always use python3, so we will need to know it&#8217;s absolute path :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ which python3
/usr/bin/python3
</pre></div>
</div>
<p>So, in your <code class="docutils literal"><span class="pre">.bashrc</span></code> or <code class="docutils literal"><span class="pre">.zshrc</span></code> (or whatever, depending on what interpreter you use), add this line :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">VIRTUALENVWRAPPER_PYTHON</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python3</span>
</pre></div>
</div>
<p>The goal is to not install a python package in our filesystem anymore.</p>
<p>Then, you can create a folder, make a virtualenv in it and start working, but there&#8217;s something easier to use for this.
We can create a folder where we will create our virtualenvs :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">venvs</span>
</pre></div>
</div>
<p>And install virtualenvwrapper via pip3 :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">install</span> <span class="n">virtualenvwrapper</span>
</pre></div>
</div>
<p>Now, we have to specify where virtualenvs will be created, so, add those lines in your .bashrc or .zshrc :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">WORKON_HOME</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">venv</span>
<span class="n">source</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">virtualenvwrapper</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>You can now use those commands to manage your virtualenvs :</p>
<blockquote>
<div>mkvirtualenv &lt;venv_name&gt; # to create &lt;venv_name&gt;
workon nom_env # to activate &lt;venv_name&gt;
rmvirtualenv &lt;venv_name&gt; # to delete &lt;venv_name&gt;</div></blockquote>
<p>be aware that <code class="docutils literal"><span class="pre">mkvirtualenv</span></code> options are the same than <code class="docutils literal"><span class="pre">virtualenv</span></code>.</p>
<p>For the example, we will create a virtual env for <code class="docutils literal"><span class="pre">glances</span></code> :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ mkvirtualenv glances
(glances) $ pip install glances
Collecting glances
Collecting psutil&gt;=2.0.0 (from glances)
Installing collected packages: psutil, glances
Successfully installed glances-2.10 psutil-5.2.2
</pre></div>
</div>
<p>You can now exit the virtualenv and try this :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">venvs</span><span class="o">/</span><span class="n">glances</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">glances</span>
</pre></div>
</div>
<p>Let&#8217;s try to watch this on your browser :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$workon glances
(glances) $ pip install bottle
Collecting bottle
Installing collected packages: bottle
Successfully installed bottle-0.12.13
</pre></div>
</div>
<p>Exit your virtualenv and try this :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">venvs</span><span class="o">/</span><span class="n">glances</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">glances</span> <span class="o">-</span><span class="n">w</span>
</pre></div>
</div>
<p>And try to access <a class="reference external" href="http://localhost:61208">http://localhost:61208</a> from your favourite browser.
All right, now, I would create a systemd service of this.</p>
<p>First, create a file <code class="docutils literal"><span class="pre">/etc/systemd/system/glances.service</span></code> containing those lines :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Unit</span><span class="p">]</span>
<span class="n">Description</span><span class="o">=</span><span class="n">glances</span>

<span class="p">[</span><span class="n">Service</span><span class="p">]</span>
<span class="n">Type</span><span class="o">=</span><span class="n">simple</span>
<span class="n">ExecStart</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">venv</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">glances</span> <span class="o">-</span><span class="n">w</span>

<span class="p">[</span><span class="n">Install</span><span class="p">]</span>
<span class="n">WantedBy</span><span class="o">=</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="o">.</span><span class="n">target</span>
</pre></div>
</div>
<p>And activate it like that :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">enable</span> <span class="n">glances</span><span class="o">.</span><span class="n">service</span>
</pre></div>
</div>
<p>Now you can spawn glances as a service. And except pip, virtualenv and virtualenvwrapper, no additionnal package has been installed on your filesystem.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ pip list | grep glances
âˆ…
</pre></div>
</div>
<p>If one day you want to uninstall glances, just launch those commands :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rmvirtualenv</span> <span class="n">glances</span>
<span class="n">systemctl</span> <span class="n">disable</span> <span class="n">glances</span><span class="o">.</span><span class="n">service</span>
<span class="n">rm</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">glances</span><span class="o">.</span><span class="n">service</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tipsntricks/index.html" class="btn btn-neutral float-right" title="Tips â€˜n Tricks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="apache.html" class="btn btn-neutral" title="Reverse proxy with Apache (and HTTPS !)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'Personnal notes and thoughts about computer science.',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>